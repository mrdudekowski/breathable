# Iceman Technique - Эталонная логика дыхательных фаз

## Общее описание

Техника дыхания состоит из нескольких раундов. Каждый раунд содержит 30 циклов дыхания, за которыми следуют специальные задержки и пауза.

## Структура одного раунда

### 1. Циклы внутри раунда (30 циклов)

Каждый цикл состоит **только** из двух фаз:
- **Вдох** (inhale) - расширение круга
- **Выдох** (exhale) - сжатие круга

**Важно**: Внутри раунда НЕТ задержек дыхания. Только вдох и выдох повторяются 30 раз.

### 2. После последнего выдоха раунда

После завершения 30-го цикла (после выдоха) начинается **зелёная задержка**:
- Тип: `round-exhale`
- Длительность: зависит от раунда
  - Раунд 1: 30 секунд
  - Раунд 2: 60 секунд (1 минута)
  - Раунд 3: 90 секунд (1 минута 30 секунд)
- Визуально: маленький зелёный пульсирующий круг

### 3. После зелёной задержки

Последовательность:
1. **Вдох** (inhale) - оранжевый круг расширяется
2. **Синяя задержка** (hold) - когда круг заполняет кольцо
   - Тип: `global-inhale` (для последнего раунда) или `round-inhale` (для промежуточных раундов)
   - Длительность: 15 секунд
   - Визуально: заполненный синий круг
3. **Выдох** (exhale) - оранжевый круг сжимается

**Критически важно**: После синей задержки ОБЯЗАТЕЛЬНО должен быть выдох!

### 4. После выдоха

**Пауза** (pause):
- Длительность: 4 секунды
- Визуально: маленький оранжевый круг с лёгким сердцебиением
- UI: обратный отчёт (4, 3, 2, 1) **справа от кольца**

### 5. После паузы

- Если это не последний раунд: переход к следующему раунду (начинается с вдоха)
- Если это последний раунд: завершение дыхательной практики

## Полная последовательность для каждого раунда

### Раунд 1 (пример с 1 циклом для наглядности)

```
Вдох → Выдох → [Зелёная задержка 30 сек] → Вдох → [Синяя задержка 15 сек] → Выдох → [Пауза 4 сек] → Раунд 2
```

### Раунд 2 (пример с 1 циклом)

```
Вдох → Выдох → [Зелёная задержка 60 сек] → Вдох → [Синяя задержка 15 сек] → Выдох → [Пауза 4 сек] → Раунд 3
```

### Раунд 3 (пример с 1 циклом, последний)

```
Вдох → Выдох → [Зелёная задержка 90 сек] → Вдох → [Синяя задержка 15 сек] → Выдох → [Пауза 4 сек] → Завершение
```

## Реальная последовательность (30 циклов в каждом раунде)

### Раунд 1

1. Цикл 1: Вдох → Выдох
2. Цикл 2: Вдох → Выдох
3. ...
4. Цикл 30: Вдох → Выдох
5. Зелёная задержка (30 сек)
6. Вдох
7. Синяя задержка (15 сек)
8. Выдох
9. Пауза (4 сек, обратный отчёт справа)
10. → Раунд 2

### Раунд 2

1. Цикл 1: Вдох → Выдох
2. Цикл 2: Вдох → Выдох
3. ...
4. Цикл 30: Вдох → Выдох
5. Зелёная задержка (60 сек)
6. Вдох
7. Синяя задержка (15 сек)
8. Выдох
9. Пауза (4 сек, обратный отчёт справа)
10. → Раунд 3

### Раунд 3 (последний)

1. Цикл 1: Вдох → Выдох
2. Цикл 2: Вдох → Выдох
3. ...
4. Цикл 30: Вдох → Выдох
5. Зелёная задержка (90 сек)
6. Вдох
7. Синяя задержка (15 сек)
8. Выдох
9. Пауза (4 сек, обратный отчёт справа)
10. → Завершение практики

## Критические правила

1. **Внутри раунда (30 циклов)**: ТОЛЬКО вдох и выдох, никаких задержек
2. **После зелёной задержки**: Вдох → Синяя задержка → **Выдох** → Пауза
3. **После синей задержки ОБЯЗАТЕЛЬНО должен быть выдох** - это ключевое правило
4. **Пауза происходит после выдоха**, а не после синей задержки
5. **Обратный отчёт паузы отображается справа от кольца**, а не в центре

## Типы задержек

- `round-exhale`: Зелёная задержка после последнего выдоха раунда (30/60/90 сек)
- `round-inhale`: Синяя задержка на вдохе для промежуточных раундов (15 сек)
- `global-inhale`: Синяя задержка на вдохе для последнего раунда (15 сек)

## Визуальные состояния

- **Обычное дыхание**: Оранжевый круг, расширение/сжатие
- **Зелёная задержка**: Маленький зелёный пульсирующий круг
- **Синяя задержка**: Заполненный синий круг (maxScale)
- **Пауза**: Маленький оранжевый круг с лёгким сердцебиением, обратный отчёт справа
